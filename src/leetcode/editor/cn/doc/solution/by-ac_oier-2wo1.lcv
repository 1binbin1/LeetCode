## å­—ç¬¦ä¸²å“ˆå¸Œ

è‹¥ä¸¤å­—ç¬¦ä¸²äº’ä¸ºæ—‹è½¬ï¼Œåˆ™ã€Œå…¶ä¸€å­—ç¬¦ä¸²ã€å¿…ç„¶ä¸ºã€Œå¦ä¸€å­—ç¬¦ä¸²æ‹“å±•ä¸¤å€é•¿åº¦åï¼ˆå¾ªç¯å­ä¸²ï¼‰ã€çš„å­ä¸²ã€‚

åŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ã€Œå­—ç¬¦ä¸²å“ˆå¸Œã€è¿›è¡Œæ±‚è§£ï¼šå…ˆè®¡ç®— `s2` çš„å­—ç¬¦ä¸²å“ˆå¸Œå€¼ `t`ï¼Œç„¶åæ„é€ å‡º `s1 + s1` çš„å“ˆå¸Œæ•°ç»„å’Œæ¬¡æ–¹æ•°ç»„ï¼Œåœ¨ä¸¤æ•°ç»„ä¸­æ£€æŸ¥æ˜¯å¦å­˜åœ¨é•¿åº¦ä¸º $n$ çš„è¿ç»­å­æ®µçš„å“ˆå¸Œå€¼ `cur` ä¸ `t` ç›¸ç­‰ã€‚

**ä¸äº†è§£å­—ç¬¦ä¸²å“ˆå¸Œçš„åŒå­¦å¯ä»¥çœ‹å‰ç½®ğŸ§€ : [å­—ç¬¦ä¸²å“ˆå¸Œå…¥é—¨](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247489813&idx=1&sn=7f3bc18ca390d85b17655f7164d8e660)**

> ä¸€äº›ç»†èŠ‚ï¼šå…¶ä»–è¯­è¨€å¯èƒ½ä¸åƒ `Java` é‚£æ ·å­˜åœ¨è‡ªç„¶å–æ¨¡ï¼Œå¯æ‰‹åŠ¨å–æ¨¡ï¼Œå¯¹äºè‡ªå¸¦é«˜ç²¾åº¦çš„è¯­è¨€è‹¥ä¸å–æ¨¡ä¼šå¯¼è‡´å•æ¬¡è®¡ç®—å¤æ‚åº¦ä¸Šå‡ï¼Œä¼š `TLE`ã€‚

ä»£ç ï¼š

* []

```Java
class Solution {
    static int N = 200010, P = 13131;
    static int[] h = new int[N], p = new int[N];
    public boolean isFlipedString(String s1, String s2) {
        if (s1.length() != s2.length()) return false;
        int n = s1.length();
        for (int i = 1; i <= n; i++) h[i] = h[i - 1] * P + s2.charAt(i - 1);
        int t = h[n]; // s2 hash
        s1 = s1 + s1;
        p[0] = 1;
        for (int i = 1; i <= 2 * n; i++) {
            h[i] = h[i - 1] * P + s1.charAt(i - 1);
            p[i] = p[i - 1] * P;
        }
        for (int i = 1; i + n - 1 <= 2 * n; i++) {
            int j = i + n - 1, cur = h[j] - h[i - 1] * p[j - i + 1];
            if (cur == t) return true;
        }
        return false;
    }
}
```

* []

```Python
N, P, MOD = 200010, 13131, 987654321
h, p = [0] * N, [1] * N
class Solution:
    def isFlipedString(self, s1: str, s2: str) -> bool:
        if len(s1) != len(s2):
            return False
        if s1 == s2:
            return True
        n = len(s1)
        for i in range(1, n + 1):
            h[i] = (h[i - 1] * P + ord(s2[i - 1])) % MOD
        t = h[n]
        s1 = s1 + s1
        for i in range(1, 2 * n + 1):
            h[i] = (h[i - 1] * P + ord(s1[i - 1])) % MOD
            p[i] = (p[i - 1] * P) % MOD
        for i in range(1, n + 1):
            j = i + n - 1
            cur = (h[j] - h[i - 1] * p[j - i + 1]) % MOD
            if cur == t:
                return True
        return False
```

* æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

## ç©ºé—´ä¼˜åŒ–

è¯„è®ºåŒºæœ‰åŒå­¦æå‡ºï¼ŒåŸºäºè§£æ³•ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œç©ºé—´ä¼˜åŒ–ã€‚

ç¡®å®ï¼Œåˆ©ç”¨å®šé•¿æ»šåŠ¨æˆ‘ä»¬æ— é¡»é¢å¤–ä¿å­˜æ•´ä¸ªå“ˆå¸Œæ•°ç»„å’Œæ¬¡æ–¹æ•°ç»„ï¼Œè€Œå¯ä»¥é‡‡ç”¨ä¸¤ä¸ªå˜é‡ä»£æ›¿ï¼ŒåŒæ—¶ç›´æ¥çš„å­—ç¬¦ä¸²æ‹¼æ¥ä¹Ÿä¼šäº§ç”Ÿæ–°å­—ç¬¦ä¸²å¯¼è‡´ç©ºé—´ä¸º $O(n)$ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡ä¸‹æ ‡å–æ¨¡æ¥ä»£æ›¿çœŸå®æ‹¼æ¥ã€‚

ä½†æ— è®ºå¦‚ä½•ï¼Œè¿™ç‚¹ç©ºé—´ä¼˜åŒ–æ„ä¹‰ä¸å¤§ï¼Œå†™æ¥ä¾›å¤§å®¶å‚è€ƒå§ã€‚

ä»£ç ï¼š

* []

```Java
class Solution {
    int P = 13131;
    public boolean isFlipedString(String s1, String s2) {
        if (s1.length() != s2.length()) return false;
        if (s1.equals(s2)) return true;
        int n = s1.length();
        int t = 0;
        for (int i = 1; i <= n; i++) t = t * P + s2.charAt(i - 1);
        int hl = 0, hr = 0, p = P;
        for (int i = 1; i < n; i++) {
            hr = hr * P + s1.charAt(i - 1);
            p *= P;
        }
        for (int i = n; i <= 2 * n; i++) {
            int j = i - n + 1;
            hr = hr * P + s1.charAt((i - 1) % n);
            int cur = hr - hl * p;
            if (cur == t) return true;
            hl = hl * P + s1.charAt((j - 1) % n);
        }
        return false;
    }
}
```

* æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$

